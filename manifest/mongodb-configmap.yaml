apiVersion: v1
kind: ConfigMap
metadata:
  name: mongodb-configmap
data:
  mongodb-init.sh: |
    #!/bin/bash
    mongod --fork --bind_ip_all --logpath /var/log/mongod.log
    mongosh <<EOF
    db = db.getSiblingDB('demo')
    db.createUser({
      user: 'demo',
      pwd: '$DEMO_PASSWORD',
      roles: [{ role: 'readWrite', db: 'demo' }],
    });
    db.createCollection('utlmap')
    EOF
